# 基于DCT+DWT+SVD的图像水印嵌入与提取

一个使用python实现的基于`DCT+DWT+SVD`的图像水印嵌入与提取。使用嵌入后图片与原始图片的`psnr`值来判断本方法的隐蔽性；使用经过高斯噪声攻击后提取的水印与原始水印的`NC`值来判断本方法的鲁棒性。

## 1.原理介绍

### 1.1 离散余弦变换（DCT）

DCT将图像从空间域转换到频域，通过余弦基函数的正交特性分解图像。具体步骤包括：

- 分块处理​​：将图像分割为8×8或16×16的小块（如JPEG标准）
- 频域转换​​：每个图像块通过二维DCT变换得到系数矩阵，其中低频系数（靠近左上角）集中了大部分能量，高频系数（右下角）对应细节和噪声

### 1.2 离散小波变换（DWT）

DWT通过多级分解将图像划分为不同频率的子带：

- 多分辨率分析​​：每级分解产生低频（LL）和多个高频子带（LH、HL、HH），低频保留主体信息，高频包含细节
- 方向性​​：高频子带分别对应水平、垂直和对角线方向的细节

### 1.3 奇异值分解（SVD）​​

SVD将图像矩阵分解为三个矩阵的乘积:

$$
\begin{equation}
A = U \begin{bmatrix}
\sigma_1 & 0 & \cdots & 0 \\
0 & \sigma_2 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \sigma_r
\end{bmatrix} V^{\top} \nonumber
\end{equation}
$$

- 特征提取​​：奇异值（Σ对角线元素）反映图像能量分布，大奇异值对应主要结构，小值对应细节或噪声
- 稳定性​​：对几何攻击（旋转、缩放）具有鲁棒性，适合水印和压缩

## 2.实现步骤

实现代码已提供，以下主要介绍实现思路。

### 2.1 嵌入水印

- 对图像YUV三通道中的Y通道进行三级DWT变换（使用LL子带）
- 对HH2（三级变换后的HH子带）进行DCT变换
- 分别对水印图像和HH2_dct（DCT变换后的HH2）进行SVD得到奇异值SW和HSW
- 对HSW进行替换：$$HSW=HSW+\alpha*SW(\alpha为嵌入因子)$$
- 对替换后的HSW进行DCT逆变换及三级DWT逆变换得到替换后的Y通道
- 使用替换后的Y通道替换原始图像的Y通道，并变换为RGB通道得到嵌入水印后的图像

### 2.2 提取水印

- 对嵌入水印后的图像YUV三通道中的Y通道进行三级DWT变换（使用LL子带）
- 对HH2（三级变换后的HH子带）进行DCT变换得到HH2_Ydct_watermarked
- 对水印图像进行SVD得到UW、VW
- 对HH2_Ydct_watermarked进行SVD的到$HSW'$
- 使用HSW'和HSW得到SW：$$SW=\frac{HSW'-HSW}{\alpha}$$
- 使用UW、SW、VW得到水印图像

### 2.3 攻击图像

- 对嵌入水印后的图像增加随机产生的噪声

### 2.4 PSNR值计算

- 对原始图像及嵌入水印后的图像进行`psnr`值的计算

---