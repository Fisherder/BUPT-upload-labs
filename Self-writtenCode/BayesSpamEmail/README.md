# BayesSpamEmail

一个使用 Python 实现的基于贝叶斯分类的简单垃圾邮件识别器。

测试集共 400 封邮件（正常邮件与垃圾邮件各 200 封），分类准确率达到 **95.15%**。即使仅统计词频计算概率，分类效果仍然表现良好。

## 1. 环境准备

- Python 3.4+
- 结巴分词工具：[https://github.com/fxsjy/jieba](https://github.com/fxsjy/jieba)

## 2. 贝叶斯公式

目标是根据词向量 $w = (w_1, w_2, \dots, w_n)$ 计算该邮件是垃圾邮件的概率 $P(s \mid w)$，其中 $s$ 表示邮件为垃圾邮件。

根据贝叶斯定理和全概率公式，有：

$$
P(s \mid w_1, w_2, \dots, w_n) = \frac{P(w_1, w_2, \dots, w_n \mid s) P(s)}{P(w_1, w_2, \dots, w_n)}
$$

由于：

$$
P(w_1, w_2, \dots, w_n) = P(w_1, w_2, \dots, w_n \mid s) \cdot P(s) + P(w_1, w_2, \dots, w_n \mid s') \cdot P(s')
$$

并且采用朴素贝叶斯条件独立假设以及先验概率 $P(s) = P(s') = 0.5$，可简化为：

$$
P(s \mid w) = \frac{\prod_{j=1}^n P(w_j \mid s)}{\prod_{j=1}^n P(w_j \mid s) + \prod_{j=1}^n P(w_j \mid s')}
$$

进一步利用贝叶斯公式 $P(w_j \mid s) = \frac{P(s \mid w_j) \cdot P(w_j)}{P(s)}$，可以将其表示为：

$$
P(s \mid w) = \frac{\prod_{j=1}^n P(s \mid w_j)}{\prod_{j=1}^n P(s \mid w_j) + \prod_{j=1}^n (1 - P(s \mid w_j))}
$$

> 我们使用上式计算 $P(s \mid w)$，因为它仅依赖于 $P(s \mid w_j)$，简化了计算。

## 3. 实现步骤

实现代码已提供，以下是主要思路：

1. **分词与清洗**  
   对训练集邮件使用结巴分词，结合停用词表进行过滤，并通过正则表达式去除非中文字符。

2. **构建词典**  
   分别统计正常邮件与垃圾邮件中各个词的出现频次，构建两个词典。  
   例如：词“疯狂”在 8000 封正常邮件中出现 20 次，在 8000 封垃圾邮件中出现 200 次。

3. **处理测试集**  
   对测试邮件执行相同处理，并找出使 $P(s \mid w)$ 最大的 15 个关键词。  
   - 若词只出现在垃圾邮件中，设 $P(w \mid s') = 0.01$；反之亦然。  
   - 若词在两个词典中都未出现，则设 $P(s \mid w) = 0.4$。

4. **分类判定**  
   对每封邮件选出的 15 个关键词利用前述公式计算 $P(s \mid w)$，若该值大于阈值 $\alpha$（通常设为 0.9），则判断为垃圾邮件，否则为正常邮件。

---

